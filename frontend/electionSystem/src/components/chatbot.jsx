import React, { useState, useEffect } from "react";
import { FaRobot, FaUser, FaPaperPlane } from "react-icons/fa";

const responses = {
  مرحبا: "مرحبا! كيف يمكنني مساعدتك اليوم؟",
  "كيف حالك": "أنا مجرد روبوت، لكنني بخير! كيف يمكنني مساعدتك؟",
  "السلام عليكم": "وعليكم السلام! كيف يمكنني مساعدتك؟",
  "أريد أن أسألك": "بالطبع، أنا هنا للإجابة على أسئلتك. ماذا تريد أن تعرف؟",
  "ما هو اسمك؟": "أنا روبوت مساعد هنا لمساعدتك في أي استفسار.",
  "هل يمكنك مساعدتي؟": "نعم، بالطبع! كيف يمكنني مساعدتك؟",
  "شكراً لك": "على الرحب والسعة! إذا كنت بحاجة إلى أي شيء آخر، فأنا هنا.",
  وداعاً:
    "وداعاً! إذا كنت بحاجة إلى أي مساعدة أخرى في المستقبل، لا تتردد في العودة.",
  "ما هو الوقت الآن؟":
    "عذرًا، لا أستطيع معرفة الوقت الحالي. يمكنك التحقق من جهازك لمعرفة الوقت.",
  "أين أستطيع العثور على معلومات حول الانتخابات؟":
    "يمكنك العثور على معلومات حول الانتخابات في هذا الموقع أو من خلال الاتصال بالجهات المختصة.",
  "ما هي الأنشطة التي يمكن القيام بها في الأردن؟":
    "الأردن يقدم العديد من الأنشطة مثل زيارة المواقع السياحية التاريخية، الرحلات في الصحراء، واستكشاف الطبيعة.",
  "هل يمكنني الحصول على مزيد من المعلومات؟":
    "بالطبع، يمكنك طرح أي سؤال آخر، وسأبذل قصارى جهدي لتقديم الإجابة.",
  "ما هي الخطوة التالية؟":
    "اعتمادًا على ما تحتاجه، يمكنني توجيهك إلى الخطوة التالية أو تقديم المعلومات المطلوبة.",
  "هل هناك أي تحديثات جديدة؟":
    "للحصول على أحدث المعلومات، يرجى متابعة الأخبار المحلية أو الموقع الرسمي المتعلق بالموضوع.",
  "ما هي الانتخابات؟":
    "الانتخابات هي عملية يتم فيها اختيار ممثلين لتولي المناصب العامة.",
  "متى تجري الانتخابات في الأردن؟":
    "الانتخابات في الأردن تُجرى عادةً كل أربع سنوات.",
  "ما هي الدوائر الانتخابية في الأردن؟":
    "الأردن مقسم إلى دوائر انتخابية مختلفة، كل دائرة لها عدد معين من المقاعد في البرلمان.",
  "ما هي نسبة المشاركة في الانتخابات؟":
    "نسبة المشاركة في الانتخابات تختلف من دورة انتخابية إلى أخرى.",
  "ما هي الانتخابات النيابية؟":
    "الانتخابات النيابية هي عملية انتخاب أعضاء مجلس النواب.",
  "ما هو مجلس النواب؟":
    "مجلس النواب هو الهيئة التشريعية في الأردن التي تتكون من أعضاء منتخبين.",
  "كم عدد أعضاء مجلس النواب في الأردن؟":
    "مجلس النواب الأردني يتكون من 130 عضواً.",
  "ما هي الانتخابات البلدية؟":
    "الانتخابات البلدية هي عملية انتخاب أعضاء المجالس المحلية.",
  "ما هي المجالس المحلية؟":
    "المجالس المحلية هي هيئات محلية تدير شؤون البلديات والمناطق.",
  "من يحق له التصويت في الانتخابات؟":
    "يحق لجميع المواطنين الأردنيين البالغين 18 عاماً فما فوق التصويت في الانتخابات.",
  "ما هي معايير الترشح للانتخابات؟":
    "يجب أن يكون المرشح مواطناً أردنياً، ويبلغ من العمر 30 عاماً على الأقل، ويجب أن يكون مسجلاً في دائرة انتخابية.",
  "متى تُجرى الانتخابات البلدية؟": "تُجرى الانتخابات البلدية كل أربع سنوات.",
  "ما هي دورات الانتخابات في الأردن؟":
    "تشمل الانتخابات النيابية والبلدية، بالإضافة إلى الانتخابات للأعيان.",
  "ما هو دور الأعيان في الأردن؟":
    "الأعيان هم أعضاء في مجلس الأعيان الذي يتم تعيينهم وليس انتخابهم.",
  "كم عدد أعضاء مجلس الأعيان؟": "مجلس الأعيان يتكون من 65 عضواً.",
  "ما هي إجراءات الترشح للانتخابات؟":
    "يجب على المرشح تقديم طلب للترشح وتلبية جميع المتطلبات القانونية.",
  "هل يمكن للأجانب التصويت في الانتخابات الأردنية؟":
    "لا، فقط المواطنين الأردنيين يحق لهم التصويت.",
  "كيف يتم احتساب الأصوات في الانتخابات؟":
    "يتم احتساب الأصوات بناءً على نظام انتخابي محدد، وعادة ما يكون النظام النسبي أو الأغلبي.",
  "ما هي عملية الاقتراع؟":
    "الاقتراع هو عملية إدلاء الناخبين بأصواتهم في الانتخابات.",
  "هل يمكن للناخبين التصويت عبر الإنترنت؟":
    "لا، التصويت في الانتخابات الأردنية يتم بشكل حضوري.",
  "ما هي الانتخابات الفرعية؟":
    "الانتخابات الفرعية تُجرى لملء المقاعد الشاغرة في مجلس النواب أو المجالس المحلية.",
  "متى تُجرى الانتخابات الفرعية؟":
    "تُجرى الانتخابات الفرعية عند الحاجة لملء المقاعد الشاغرة.",
  "ما هو دور الهيئة المستقلة للانتخاب؟":
    "الهيئة المستقلة للانتخاب هي الجهة المسؤولة عن تنظيم وإدارة الانتخابات في الأردن.",
  "ما هي الشروط للتسجيل في الانتخابات؟":
    "يجب أن يكون المواطن أردنياً، ويبلغ من العمر 18 عاماً، ولديه بطاقة انتخابية سارية.",
  "ما هي بطاقة الناخب؟":
    "بطاقة الناخب هي وثيقة تستخدم للتسجيل في الانتخابات والتصويت.",
  "كيف يمكن الحصول على بطاقة الناخب؟":
    "يمكن الحصول على بطاقة الناخب من خلال التسجيل في دائرة الأحوال المدنية.",
  "ما هي صلاحيات مجلس النواب؟":
    "مجلس النواب يضع القوانين ويشرف على عمل الحكومة ويقوم بتمثيل الشعب.",
  "هل يمكن للنساء الترشح في الانتخابات؟":
    "نعم، يمكن للنساء الترشح في الانتخابات وممارسة حقهن في التصويت.",
  "ما هي نسبة تمثيل النساء في مجلس النواب؟":
    "هناك حصة مخصصة للنساء في مجلس النواب لضمان تمثيلهن.",
  "كيف يتم تعيين الأعيان؟":
    "الأعيان يتم تعيينهم من قبل الملك بناءً على التوصيات.",
  "ما هو دور الحكومة في الانتخابات؟":
    "الحكومة تتولى مسؤولية تنظيم الانتخابات وتوفير الظروف المناسبة لها.",
  "ما هي مدة فترة الانتخاب؟":
    "فترة الانتخاب تمتد لعدة ساعات في يوم الانتخابات المحدد.",
  "ما هي القوائم الانتخابية؟":
    "القوائم الانتخابية تحتوي على أسماء المرشحين وتفاصيلهم.",
  "هل يمكن التصويت في غير دائرة الناخب؟":
    "لا، يجب التصويت في الدائرة التي سجل فيها الناخب.",
  "ما هي عملية العد والتدقيق؟":
    "بعد انتهاء التصويت، يتم عد الأصوات وتدقيقها لضمان دقة النتائج.",
  "كيف يتم إعلان نتائج الانتخابات؟":
    "نتائج الانتخابات تُعلن بعد انتهاء عملية العد والتدقيق من قبل الهيئة المستقلة للانتخاب.",
  "ما هي الإجراءات القانونية للطعن في الانتخابات؟":
    "يمكن الطعن في الانتخابات من خلال تقديم شكوى إلى الهيئة المستقلة للانتخاب.",
  "ما هو نظام التصويت في الانتخابات الأردنية؟":
    "نظام التصويت في الانتخابات الأردنية يعتمد على النسبية والأغلبيات.",
  "ما هي الاستعدادات اللازمة للانتخابات؟":
    "تشمل الاستعدادات تجهيز اللجان الانتخابية، وتوزيع بطاقات الناخبين، وإعداد مراكز الاقتراع.",
  "كيف يمكن متابعة نتائج الانتخابات؟":
    "يمكن متابعة نتائج الانتخابات عبر وسائل الإعلام الرسمية والمواقع الإلكترونية.",
  "ما هو تأثير الانتخابات على الحياة السياسية؟":
    "الانتخابات تحدد التوجهات السياسية وتؤثر على تشكيل الحكومة والمجالس المحلية.",
  "هل يمكن للمرشحين إجراء حملات انتخابية؟":
    "نعم، يمكن للمرشحين إجراء حملات انتخابية لتعريف الناخبين ببرامجهم.",
  "ما هي قيود الحملات الانتخابية؟":
    "توجد قيود على الحملات الانتخابية لضمان نزاهة العملية الانتخابية، مثل منع الدعاية في الأماكن العامة.",
  "ما هي أهمية الانتخابات؟":
    "الانتخابات مهمة لضمان تمثيل المواطنين في صنع القرارات وتشكيل الحكومة.",
  "ما هي أنواع الانتخابات في الأردن؟":
    "تشمل الانتخابات النيابية، البلدية، والأعيان.",
  "كيف يتم تسجيل الناخبين الجدد؟":
    "يتم تسجيل الناخبين الجدد من خلال تقديم طلب التسجيل في دائرة الأحوال المدنية.",
  "ما هو دور المرشحين في الانتخابات؟":
    "المرشحون يقدمون برامجهم الانتخابية ويخوضون الحملات لجذب أصوات الناخبين.",
  "ما هي قواعد التصويت؟":
    "يجب على الناخبين التصويت في مراكز الاقتراع المعتمدة والتأكد من صحة بياناتهم.",
  "كيف يتم تعزيز الشفافية في الانتخابات؟":
    "يتم تعزيز الشفافية من خلال الرقابة المستقلة والإشراف الدولي على الانتخابات.",
  "ما هي أهمية التصويت المبكر؟":
    "التصويت المبكر يتيح للناخبين المشاركة في الانتخابات قبل يومها الرسمي ويساعد في تقليل الازدحام.",
  "ما هي إجراءات الأمان في مراكز الاقتراع؟":
    "تتضمن إجراءات الأمان تأمين مراكز الاقتراع ومراقبة العملية الانتخابية لضمان نزاهتها.",
  "كيف يتم تدريب أعضاء اللجان الانتخابية؟":
    "يتم تدريب أعضاء اللجان الانتخابية على الإجراءات القانونية والفنية لعملية الاقتراع.",
  "ما هو دور المراقبين الدوليين في الانتخابات؟":
    "المراقبون الدوليون يساهمون في ضمان نزاهة الانتخابات من خلال تقديم تقارير عن سير العملية الانتخابية.",
  "ما هي الخطوات التالية بعد الانتخابات؟":
    "بعد الانتخابات، يتم إعلان النتائج، تشكيل الحكومة، والتعامل مع أي طعون قد تكون مقدمة.",
  "هل يمكن للناخبين تقديم شكاوى خلال الانتخابات؟":
    "نعم، يمكن للناخبين تقديم شكاوى حول أي مخالفات أو مشاكل تحدث أثناء الانتخابات.",
  "ما هي الإجراءات لتحديث بيانات الناخبين؟":
    "يمكن تحديث بيانات الناخبين من خلال زيارة مكاتب دائرة الأحوال المدنية وتقديم الوثائق المطلوبة.",
  "ما هو دور اللجنة الانتخابية؟":
    "اللجنة الانتخابية تشرف على تنظيم الانتخابات وضمان سيرها بشكل قانوني ومنظم.",
  "هل يتم توفير المساعدة للناخبين ذوي الاحتياجات الخاصة؟":
    "نعم، يتم توفير المساعدة والتسهيلات اللازمة للناخبين ذوي الاحتياجات الخاصة.",
  "كيف يتم تحديد عدد مقاعد كل دائرة انتخابية؟":
    "عدد مقاعد كل دائرة انتخابية يتم تحديده بناءً على عدد السكان والتوزيع الجغرافي.",
  "ما هي أبرز التحديات التي تواجه الانتخابات في الأردن؟":
    "تشمل التحديات الشفافية، نزاهة الانتخابات، وزيادة نسبة المشاركة.",
  "ما هي حقوق الناخبين؟":
    "حقوق الناخبين تشمل الحق في التصويت، السرية، ومطالبة نتائج الانتخابات.",
  "ما هي واجبات الناخبين؟":
    "واجبات الناخبين تشمل التصويت بضمير، التحقق من بياناتهم، واحترام القوانين الانتخابية.",
  "كيف يمكن للناخبين التأكد من صحة نتائج الانتخابات؟":
    "يمكن التأكد من صحة نتائج الانتخابات من خلال متابعة التقارير الرسمية ونتائج الفرز.",
  "ما هي أنواع التصويت في الانتخابات؟":
    "تشمل أنواع التصويت التصويت العادي، التصويت بالبريد، والتصويت المبكر.",
  "ما هو تصويت الغائبين؟":
    "تصويت الغائبين هو نظام يتيح للناخبين الذين لا يستطيعون التواجد في مراكز الاقتراع يوم الانتخابات الإدلاء بأصواتهم بوسائل بديلة.",
  "كيف يمكن للناخبين تسجيل شكاوى انتخابية؟":
    "يمكن للناخبين تسجيل شكاوى عبر تقديم اعتراضات رسمية للهيئة المستقلة للانتخاب أو من خلال اللجان المشرفة.",
  "ما هي أنواع التزوير الانتخابي؟":
    "تشمل أنواع التزوير الانتخابي التلاعب في بطاقات الاقتراع، التزوير في تسجيل الناخبين، وشراء الأصوات.",
  "كيف يتم التعامل مع التزوير الانتخابي؟":
    "يتم التعامل مع التزوير الانتخابي من خلال التحقيقات القانونية وفرض العقوبات على المتورطين.",
  "ما هي المراقبة الدولية للانتخابات؟":
    "المراقبة الدولية تشمل إرسال فرق من منظمات دولية لمراقبة سير الانتخابات وتقديم تقارير حول نزاهتها.",
  "كيف يمكن للمرشحين تحسين حملاتهم الانتخابية؟":
    "يمكن للمرشحين تحسين حملاتهم من خلال استراتيجيات فعالة للتواصل مع الناخبين، وتقديم برامج واضحة وجاذبة.",
  "ما هو التأثير الاجتماعي للانتخابات؟":
    "الانتخابات تؤثر على المجتمع من خلال تشكيل السياسات العامة وتوجيه الموارد وتعزيز المشاركة السياسية.",
  "ما هي التحديات التي تواجه الحملات الانتخابية في المناطق الريفية؟":
    "تشمل التحديات الوصول إلى الناخبين، البنية التحتية، وتوفير الموارد اللازمة للتواصل الفعّال.",
  "ما هي القوانين التي تنظم الحملات الانتخابية؟":
    "تنظم القوانين الحملات الانتخابية من خلال وضع قيود على الدعاية، التمويل، والتبرعات.",
  "ما هي أهمية إعلانات الحملات الانتخابية؟":
    "إعلانات الحملات الانتخابية مهمة لتثقيف الناخبين حول المرشحين وبرامجهم وزيادة الوعي بالانتخابات.",
  "كيف يتم تمويل الحملات الانتخابية؟":
    "يتم تمويل الحملات الانتخابية من خلال التبرعات الخاصة، التمويل العام، والإنفاق الشخصي للمرشحين.",
  "ما هي استراتيجيات التأثير على الناخبين؟":
    "تشمل استراتيجيات التأثير على الناخبين الحملات الإعلامية، الاجتماعات الجماهيرية، ووسائل التواصل الاجتماعي.",
  "ما هي أنواع الأنظمة الانتخابية؟":
    "تشمل الأنظمة الانتخابية النظام الأغلبي، النسبي، والنظام المختلط.",
  "ما هو نظام التصويت بالأصوات الإضافية؟":
    "نظام التصويت بالأصوات الإضافية يتيح للناخبين التصويت لأكثر من مرشح في نفس الدائرة الانتخابية.",
  "كيف يمكن تحسين نسبة المشاركة في الانتخابات؟":
    "يمكن تحسين نسبة المشاركة من خلال حملات توعية، تسهيل عملية التصويت، وتوفير معلومات واضحة حول الانتخابات.",
  "ما هي الأساليب المستخدمة لزيادة الوعي بالانتخابات؟":
    "تشمل الأساليب استخدام وسائل الإعلام، الحملات الإعلانية، وتقديم معلومات شاملة عبر المنصات الرقمية.",
  "ما هي القوانين المتعلقة بالتمويل السياسي؟":
    "تحدد القوانين المتعلقة بالتمويل السياسي كيفية جمع واستخدام الأموال خلال الحملات الانتخابية، بما في ذلك قيود على التبرعات.",
  "ما هي معايير قبول المرشحين في الانتخابات؟":
    "معايير قبول المرشحين تشمل الجنسية، العمر، التسجيل في الدائرة الانتخابية، وتلبية الشروط القانونية الأخرى.",
  "ما هو دور الإعلام في الانتخابات؟":
    "يلعب الإعلام دوراً مهماً في تقديم المعلومات للناخبين، تغطية الأحداث الانتخابية، وتحليل النتائج.",
  "كيف يتم فرز الأصوات؟":
    "يتم فرز الأصوات من خلال عملية منظمة تشمل عد الأصوات في مراكز الاقتراع ثم نقلها إلى اللجان المشرفة للتدقيق النهائي.",
  "ما هي طرق التصويت المتاحة للناخبين؟":
    "تشمل طرق التصويت التصويت الشخصي في مراكز الاقتراع، التصويت بالبريد، والتصويت عبر الإنترنت (في بعض الحالات).",
  "كيف يؤثر النظام الانتخابي على النتائج؟":
    "يؤثر النظام الانتخابي على كيفية توزيع المقاعد بين المرشحين والأحزاب، ويحدد آلية احتساب الأصوات.",
  "ما هي الإجراءات لضمان نزاهة الانتخابات؟":
    "تشمل الإجراءات لضمان نزاهة الانتخابات تنظيم العملية من قبل هيئة مستقلة، الرقابة على الحملات، وضمان الشفافية في كل خطوة.",
  "ما هي المشاكل الشائعة في العملية الانتخابية؟":
    "تشمل المشاكل الشائعة التأخير في التصويت، الطعون القانونية، وأخطاء في فرز الأصوات.",
  "ما هو دور الوكلاء في الانتخابات؟":
    "الوكلاء يمثلون المرشحين أو الأحزاب في مراكز الاقتراع للتأكد من سير العملية بشكل صحيح وتسجيل أي مخالفات.",
  "كيف يتم التعامل مع النزاعات الانتخابية؟":
    "يتم التعامل مع النزاعات من خلال لجان الطعون القضائية التي تنظر في الشكاوى وتقرر بشأنها.",
  "ما هي الفوائد الاقتصادية للانتخابات؟":
    "تشمل الفوائد الاقتصادية تعزيز الاستقرار السياسي، تحسين بيئة الأعمال، وزيادة الاستثمارات.",
  "كيف تؤثر الانتخابات على السياسة الخارجية؟":
    "تؤثر الانتخابات على السياسة الخارجية من خلال تحديد أولويات الحكومة الجديدة في العلاقات الدولية والتعاون مع الدول الأخرى.",
  "ما هو دور الأحزاب السياسية في الانتخابات؟":
    "تلعب الأحزاب السياسية دوراً في تنظيم الحملات، تقديم مرشحين، وتشكيل البرامج الانتخابية.",
  "كيف يمكن تحسين العملية الانتخابية؟":
    "يمكن تحسين العملية الانتخابية من خلال تحديث الأنظمة التكنولوجية، تدريب العاملين، وزيادة الشفافية.",
  "ما هو دور الشباب في الانتخابات؟":
    "يعتبر الشباب فئة مهمة في الانتخابات، حيث يمكنهم التأثير على النتائج من خلال التصويت والمشاركة النشطة في الحملات.",
  "ما هي قوانين الدعاية الانتخابية؟":
    "تنظم قوانين الدعاية الانتخابية كيفية تقديم الإعلانات، استخدام وسائل الإعلام، وتقييد التأثيرات غير القانونية.",
  "ما هي أبرز التعديلات القانونية التي تمت على الانتخابات؟":
    "تشمل التعديلات القانونية تحديث القوانين المتعلقة بالتمويل، شروط الترشح، وإجراءات التصويت.",
  "كيف يمكن للناخبين الجدد التسجيل؟":
    "يمكن للناخبين الجدد التسجيل من خلال زيارة مراكز التسجيل الرسمية وتقديم الوثائق المطلوبة.",
  "ما هو دور اللجان الانتخابية؟":
    "اللجان الانتخابية تشرف على العملية الانتخابية في مراكز الاقتراع وتضمن التزامها بالقوانين.",
  "ما هي التحديات التقنية في الانتخابات؟":
    "تشمل التحديات التقنية الأمان الإلكتروني، الأعطال في أنظمة التصويت، وضمان دقة البيانات.",
  "كيف يمكن تعزيز التعليم الانتخابي؟":
    "يمكن تعزيز التعليم الانتخابي من خلال البرامج التثقيفية في المدارس، حملات التوعية العامة، وورش العمل.",
  "ما هو تأثير الانتخابات على المجتمع المدني؟":
    "تؤثر الانتخابات على المجتمع المدني من خلال تعزيز المشاركة السياسية، زيادة الوعي، وتقوية الديمقراطية.",
  "كيف يتم إعداد مراكز الاقتراع؟":
    "تتم إعداد مراكز الاقتراع بتجهيز المرافق، تدريب الموظفين، وتوفير المواد اللازمة للتصويت.",
  "ما هي وسائل التواصل الاجتماعي وتأثيرها على الانتخابات؟":
    "وسائل التواصل الاجتماعي تؤثر على الانتخابات من خلال توفير منصة للتواصل المباشر مع الناخبين، نشر المعلومات، وتنظيم الحملات.",
};

const faqQuestions = [
  "ما هي الانتخابات؟",
  "متى تجري الانتخابات في الأردن؟",
  "ما هي الدوائر الانتخابية في الأردن؟",
  "من يحق له التصويت في الانتخابات؟",
  "ما هي معايير الترشح للانتخابات؟",
  "كيف يتم احتساب الأصوات في الانتخابات؟",
  "ما هو دور الهيئة المستقلة للانتخاب؟",
  "كيف يمكن الحصول على بطاقة الناخب؟",
  "ما هي إجراءات الترشح للانتخابات؟",
  "كيف يتم إعلان نتائج الانتخابات؟",
];

const ChatBot = () => {
  const [input, setInput] = useState("");
  const [messages, setMessages] = useState([]);
  const [suggestions, setSuggestions] = useState([]);
  const [isTyping, setIsTyping] = useState(false);

  const handleInputChange = (e) => {
    setInput(e.target.value);
  };

  const handleSubmit = (e) => {
    e.preventDefault();
    if (input.trim() === "") return;
    const userMessage = { text: input, sender: "user" };
    setMessages((prevMessages) => [...prevMessages, userMessage]);
    setInput("");
    setSuggestions([]);
    setIsTyping(true);

    setTimeout(() => {
      const response = findResponse(input);
      setMessages((prevMessages) => [...prevMessages, response]);
      setIsTyping(false);
    }, 1000);
  };

  const findResponse = (query) => {
    // Remove special characters and extra spaces
    const cleanQuery = query
      .replace(/[^\w\s]/gi, "")
      .replace(/\s+/g, " ")
      .trim();

    // Check for exact match
    const exactMatch = responses[cleanQuery];
    if (exactMatch) {
      return { text: exactMatch, sender: "bot" };
    }

    // Check for partial matches
    const partialMatches = Object.keys(responses).filter((question) => {
      const cleanQuestion = question
        .replace(/[^\w\s]/gi, "")
        .replace(/\s+/g, " ")
        .trim();
      return cleanQuestion
        .split(" ")
        .some((word) => cleanQuery.split(" ").includes(word));
    });

    if (partialMatches.length > 0) {
      setSuggestions(partialMatches);
      return {
        text: "هل تقصد إحدى هذه الأسئلة؟",
        sender: "bot",
        suggestions: partialMatches,
      };
    }

    // Check for similar questions
    const similarQuestions = Object.keys(responses).filter((question) => {
      const cleanQuestion = question
        .replace(/[^\w\s]/gi, "")
        .replace(/\s+/g, " ")
        .trim();
      return (
        cleanQuestion.toLowerCase().includes(cleanQuery.toLowerCase()) ||
        cleanQuery.toLowerCase().includes(cleanQuestion.toLowerCase())
      );
    });

    if (similarQuestions.length > 0) {
      setSuggestions(similarQuestions);
      return {
        text: "هل تقصد إحدى هذه الأسئلة؟",
        sender: "bot",
        suggestions: similarQuestions,
      };
    }

    return {
      text: "عذرًا، لم أفهم سؤالك. هل يمكنك إعادة صياغته؟",
      sender: "bot",
    };
  };

  const handleSuggestionClick = (question) => {
    const response = { text: responses[question], sender: "bot" };
    setMessages((prevMessages) => [...prevMessages, response]);
    setSuggestions([]);
  };

  const handleFaqClick = (question) => {
    const userMessage = { text: question, sender: "user" };
    const botResponse = {
      text: responses[question] || "عذرًا، لم أجد إجابة لهذا السؤال.",
      sender: "bot",
    };
    setMessages((prevMessages) => [...prevMessages, userMessage, botResponse]);
  };

  useEffect(() => {
    const chatContainer = document.getElementById("chat-container");
    chatContainer.scrollTop = chatContainer.scrollHeight;
  }, [messages]);

  const highlightMatches = (text, query) => {
    const cleanQuery = query
      .replace(/[^\w\s]/gi, "")
      .replace(/\s+/g, " ")
      .trim();
    const parts = text.split(new RegExp(`(${cleanQuery})`, "gi"));
    return parts.map((part, index) =>
      part.toLowerCase() === cleanQuery.toLowerCase() ? (
        <span key={index} className="bg-yellow-200">
          {part}
        </span>
      ) : (
        part
      )
    );
  };

  return (
    <div className="flex flex-col h-[66vh] w-1/3 mx-auto border border-gray-300 rounded-lg shadow-lg bg-gray-100">
      <style>
        {`
          #chat-container::-webkit-scrollbar {
            width: 6px;
          }
          #chat-container::-webkit-scrollbar-thumb {
            background-color: #22c55e;
            border-radius: 3px;
          }
          #chat-container::-webkit-scrollbar-track {
            background-color: #e5e7eb;
          }
        `}
      </style>
      <div
        id="chat-container"
        className="flex-grow overflow-y-auto p-4 space-y-4"
      >
        <div className="text-center mb-4">
          <h2 className="text-xl font-bold mb-2">الأسئلة الشائعة</h2>
          <div className="grid grid-cols-2 gap-2">
            {faqQuestions.map((question, index) => (
              <button
                key={index}
                onClick={() => handleFaqClick(question)}
                className="bg-white hover:bg-gray-200 text-sm p-2 rounded shadow"
              >
                {question}
              </button>
            ))}
          </div>
        </div>
        {messages.map((message, index) =>
          message && message.sender ? (
            <div
              key={index}
              className={`flex ${
                message.sender === "user" ? "justify-end" : "justify-start"
              }`}
            >
              <div
                className={`max-w-3/4 p-3 rounded-lg ${
                  message.sender === "user"
                    ? "bg-green-600 text-white"
                    : "bg-white text-black border border-gray-300"
                }`}
              >
                <div className="flex items-center mb-2">
                  {message.sender === "user" ? (
                    <FaUser className="mr-2" />
                  ) : (
                    <FaRobot className="mr-2" />
                  )}
                  <span className="font-bold">
                    {message.sender === "user" ? "أنت" : "بوت"}
                  </span>
                </div>
                <p>{message.text}</p>
                {message.suggestions && (
                  <ul className="mt-2 space-y-1">
                    {message.suggestions.map((suggestion, i) => (
                      <li
                        key={i}
                        onClick={() => handleSuggestionClick(suggestion)}
                        className="cursor-pointer hover:bg-gray-100 p-1 rounded"
                      >
                        {highlightMatches(suggestion, input)}
                      </li>
                    ))}
                  </ul>
                )}
              </div>
            </div>
          ) : null
        )}
        {isTyping && (
          <div className="flex justify-start">
            <div className="bg-white text-black p-3 rounded-lg border border-gray-300">
              <div className="flex items-center">
                <FaRobot className="mr-2" />
                <span className="font-bold">بوت</span>
              </div>
              <p>جاري الكتابة...</p>
            </div>
          </div>
        )}
      </div>
      <form onSubmit={handleSubmit} className="p-4 bg-gray-200">
        <div className="flex items-center">
          <input
            type="text"
            value={input}
            onChange={handleInputChange}
            placeholder="اكتب سؤالك هنا..."
            className="flex-grow p-2 border border-gray-300 rounded-l-lg focus:outline-none focus:ring-2 focus:ring-green-600"
            dir="rtl"
          />
          <button
            type="submit"
            className="bg-green-600 text-white p-2 rounded-r-lg hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-600"
          >
            <FaPaperPlane />
          </button>
        </div>
      </form>
    </div>
  );
};

export default ChatBot;
